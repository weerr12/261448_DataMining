import numpy as np
import matplotlib.pyplot as plt
from scipy import linalg
from numpy.linalg import matrix_power

# ข้อมูล x และ y 168 ข้อมูล

x = [
    2, 3, 4, 6, 8, 12, 11, 13, 14, 16, 18, 20, 21, 23, 24, 26, 28, 29, 31, 33,
    34, 36, 38, 39, 41, 42, 44, 46, 47, 49, 51, 52, 54, 55, 57, 59, 60, 62, 64,
    65, 67, 69, 70, 72, 73, 75, 77, 78, 80, 82, 83, 85, 87, 88, 90, 91, 93, 95,
    96, 98, 100, 101, 103, 104, 106, 108, 109, 111, 113, 114, 116, 118, 119, 121,
    122, 124, 126, 127, 129, 131, 132, 134, 136, 137, 139, 140, 142, 144, 145,
    147, 149, 150, 152, 153, 155, 157, 158, 160, 162, 163, 165, 167, 168, 170,
    171, 173, 175, 176, 178, 180, 181, 183, 185, 186, 188, 189, 191, 193, 194,
    196, 198, 199, 201, 202, 204, 206, 207, 209, 211, 212, 214, 216, 217, 219,
    220, 222, 224, 225, 227, 229, 230, 232, 234, 235, 237, 238, 240, 242, 243,
    245, 247, 248, 250, 251, 253, 255, 256, 258, 260, 261, 263, 265, 266, 268,
    269, 271, 273, 274, 276, 278, 279, 281, 283, 284, 286, 287, 289, 291, 292,
    294, 296, 297, 299, 300, 302, 304, 305, 307, 309, 310, 312, 314, 315, 317,
    318, 320, 322, 323, 325, 327
]
y = [
    144, 96, 95, 140, 153, 62, 101, 158, 122, 53, 110, 194, 133, 126, 156, 119,
    83, 52, 114, 159, 84, 136, 191, 148, 89, 209, 211, 184, 196, 220, 197, 215,
    189, 184, 212, 208, 198, 185, 188, 193, 220, 220, 190, 208, 214, 207, 211,
    200, 188, 186, 259, 267, 260, 291, 296, 237, 297, 267, 263, 279, 272, 299,
    255, 295, 248, 312, 231, 392, 240, 427, 336, 238, 480, 423, 378, 349, 247,
    493, 496, 394, 568, 581, 778, 663, 684, 658, 521, 651, 630, 796, 556, 539,
    787, 666, 691, 583, 582, 747, 709, 780, 632, 627, 684, 521, 684, 525, 717,
    589, 608, 718, 640, 713, 677, 766, 752, 666, 729, 746, 733, 642, 607, 765,
    652, 759, 789, 611, 736, 668, 612, 696, 678, 693, 885, 780, 823, 880, 845,
    775, 771, 790, 852, 818, 825, 794, 877, 864, 854, 766, 785, 864, 876, 885,
    779, 849, 764, 862, 853, 840, 856, 830, 841, 809, 851, 758, 899, 758, 858,
    820, 972, 998, 956, 935, 905, 913, 949, 976, 954, 922, 945, 916, 945, 931,
    938, 993, 975, 973, 925, 960, 911, 908, 936, 917, 971, 922, 919, 923, 973,
    969, 990, 902
]


# สร้าง array ของ xp
xp = np.arange(1., 9., 0.01)  # array มี 100 จุด ระหว่าง 1 ถึง 9
yp = []
e = []
ep = []
j = []

# วนลูปเพื่อสร้างและวิเคราะห์ polynomial
for i in range(1, 7, 1):
    print("\nRound ", i)
    p = np.polyfit(x, y, i)  # คำนวณ polynomial fitting
    p = np.poly1d(p)  # สร้าง polynomial

    print("\n Polynomial degree", i, "= \n", p)
    yp[:] = np.polyval(p, xp)  # คำนวณค่าจาก polynomial
    e[:] = (np.polyval(p, x) - y)  # หาค่าความต่าง
    e = np.array(e)  # เปลี่ยนเป็น matrix
    ep = e * e  # matrix operation (ค่าความต่างยกกำลังสอง)
    j = sum(ep)  # รวมค่าความต่างทั้งหมด
    print("Error(J) is : ", j)

    # สร้าง subplot
    d = plt.subplot(2, 3, i)
    d.plot(xp, yp[:], x, y, 'o')


# แสดงกราฟ
plt.show()
